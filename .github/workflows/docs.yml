name: Build and Deploy
on:
  push:
    branches:
      - main
      - dev

env:
  GLEv: '4.3.2'

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install GLE
        run: |
            curl -L https://sourceforge.net/projects/glx/files/gle/${{env.GLEv}}/gle-${{env.GLEv}}-Linux.zip/download > gle.zip
            unzip gle.zip
      - uses: tlienart/xranklin-build-action@v2.1
        with:
          BASE_URL_PREFIX: "GLEPlot.jl"
          SITE_FOLDER: "docs/"
          JULIA_SETUP: '
            ENV["GLE"] = "gle-${{env.GLEv}}-Linux/bin/gle";
            Pkg.add(url="https://github.com/tlienart/GLEPlot.jl", rev="dev");
            '
          CLEAR_CACHE: ${{ contains(github.event.head_commit.message, '[clear]') }}
          CACHE_KEY: "franklin-cache"
